jQuery(document).ready(function(t){"use strict";t("#connect_to_instance").dialog({autoOpen:!1,modal:!0,open:function(e,n){t(".ui-dialog-titlebar-close").hide(),(JSON.parse(localStorage.getItem("gianism-mastodon-recently-use-instance"))||[]).forEach(function(e){e&&t("#recentry-instances").append(t("<li>").append(t("<a>").attr("href",e).attr("rel","nofollow").addClass("wpg-button connect").text(e).click(function(n){n.preventDefault(),t("#instance_url").val(e),t("#dialog_accept_button").click()})))})},close:function(e,n){t("#connect_to_instance_error").hide(),t("#instance_url").removeClass("ui-state-error").val(""),t("#recentry-instances").empty()},buttons:[{text:"OK",click:function(){var e=t("#instance_url").val(),n=t(this).data("link");t.getJSON(wpApiSettings.root+"gianism-mastodon/v1/instance",{url:e}).done(function(t){if("uri"in t){var o=t.uri,a=JSON.parse(localStorage.getItem("gianism-mastodon-recently-use-instance"))||[],c=a.indexOf(o);c>=0&&a.splice(c,1),a.unshift(o),a.length=5,localStorage.setItem("gianism-mastodon-recently-use-instance",JSON.stringify(a));var i=n.href,l=i.match(/^(.*instance_url=)%2A(.*)$/);l&&(i=l[1]+encodeURIComponent(e)+l[2],location.href=i)}}).fail(function(e){t("#connect_to_instance_error").show(),t("#instance_url").addClass("ui-state-error").focus()})},id:"dialog_accept_button"},{text:"Cancel",click:function(){t(this).dialog("close")}}]}),t(".with-instance-dialog").click(function(e){e.preventDefault(),t("#connect_to_instance").data("link",this).dialog("open")}),t("#comment_link_acct_delete_dialog").dialog({autoOpen:!1,modal:!0,open:function(e,n){t(".ui-dialog-titlebar-close").hide()},buttons:[{text:"OK",click:function(){t.ajax({url:wpApiSettings.root+"gianism-mastodon/v1/comment_link",method:"DELETE",dataType:"json",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",wpApiSettings.nonce)}}).done(function(e,n,o){t("#comment_link_acct_delete_dialog").dialog("close")}).fail(function(e,n,o){t("#comment_link_acct").val(t("#comment_link_acct").data("previouse_selected_value")),t(this).dialog("close")})}},{text:"Cancel",click:function(){t("#comment_link_acct").val(t("#comment_link_acct").data("previouse_selected_value")),t(this).dialog("close")}}]}),t("#comment_link_acct_dialog").dialog({autoOpen:!1,modal:!0,open:function(e,n){t(".ui-dialog-titlebar-close").hide()},buttons:[{text:"OK",click:function(){var e=t("#comment_link_acct").val(),n=t("#comment_link_acct").data("href");t.ajax({url:wpApiSettings.root+"gianism-mastodon/v1/extract_domain",method:"POST",data:{url:e},dataType:"json",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",wpApiSettings.nonce)}}).done(function(t){var o=n.match(/^(.*instance_url)(.*)$/);o&&(n=o[1]+"="+encodeURIComponent(t.instance_url)+"&amp;acct="+encodeURIComponent(e)+o[2],location.href=n)}).fail(function(){t("#comment_link_acct").val(t("#comment_link_acct").data("previouse_selected_value")),t(this).dialog("close")})}},{text:"Cancel",click:function(){t("#comment_link_acct").val(t("#comment_link_acct").data("previouse_selected_value")),t(this).dialog("close")}}]}),t("#comment_link_acct").on("focus",function(e){t(this).data("previouse_selected_value",t(this).val())}).on("change",function(e){t(this).val()?t("#comment_link_acct_dialog").data("link",this).dialog("open"):t("#comment_link_acct_delete_dialog").dialog("open")}),t(".tag_insert_buttons").on("click","button",function(e){var n="#"+t(".tag_insert_buttons").data("for"),o=t(n).val(),a=t(n).prop("selectionStart"),c=t(n).prop("selectionEnd"),i=t(e.target).text();t(n).val(o.substr(0,a)+i+o.substr(c)).prop({selectionStart:a+i.length,selectionEnd:a+i.length}).trigger("focus")})});
//# sourceMappingURL=map/gianism-mastodon-script.js.map
